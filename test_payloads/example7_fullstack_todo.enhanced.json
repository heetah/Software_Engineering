{
  "comment": "Example 7: Full-Stack Todo List with Python Flask Backend - Testing complex frontend-backend integration",
  "output": {
    "coder_instructions": {
      "task": "Create a full-stack todo list application with Flask backend, user authentication, and real-time updates",
      "requirements": "User login/logout, JWT authentication, add/edit/delete tasks via API, filter by status and priority, due date handling, task search, pagination, collaborative features with task assignment, real-time updates via Server-Sent Events (SSE), error handling with user-friendly messages, loading states during API calls",
      "files": [
        {
          "path": "index.html",
          "type": "html",
          "description": "Main application container with two views: login view (id: login-view) with username input (id: username-input), password input (id: password-input), login button (id: login-btn), error message container (id: login-error); todo view (id: todo-view, initially hidden) with task input (id: task-input), priority dropdown (id: priority-select) with options low/medium/high, due date picker (id: due-date), add button (id: add-btn), search input (id: search-input), filter buttons (data-filter='all|active|completed|overdue'), task list container (id: task-list), pagination controls (id: pagination), task counter (id: task-count), logout button (id: logout-btn). Each task item has: checkbox (class: task-checkbox, data-task-id), task title (class: task-title), priority badge (class: priority-badge), due date display (class: due-date), edit button (data-action='edit'), delete button (data-action='delete'), assign button (data-action='assign')."
        },
        {
          "path": "style.css",
          "type": "css",
          "description": "Professional todo app styling: two-column layout with sidebar for filters and main content area, modern card design with subtle shadows and rounded corners, color-coded priority badges (low: green, medium: orange, high: red), overdue tasks highlighted in pink, completed tasks with strikethrough and reduced opacity, smooth fade-in/slide-down animations for new tasks, loading spinner overlay (class: loading-overlay), modal dialog for task editing (id: edit-modal) with backdrop, responsive design for mobile with collapsible sidebar, dark/light theme toggle support, form validation error styling."
        },
        {
          "path": "app.js",
          "type": "javascript",
          "description": "Frontend application logic: on page load check for stored JWT token, if present show todo view and load tasks, otherwise show login view. Login: POST credentials to /api/auth/login, store JWT in localStorage, show todo view on success. Logout: clear JWT, show login view. Task operations: GET /api/tasks with query params (status, priority, search, page), POST /api/tasks with {title, priority, dueDate}, PUT /api/tasks/:id for updates, DELETE /api/tasks/:id, PATCH /api/tasks/:id/toggle for completion. Use fetch with Authorization: Bearer <token> header. Handle API errors with user-friendly messages. Implement debounced search (300ms delay). Setup SSE connection to /api/tasks/stream for real-time updates. Pagination: track current page, show 10 tasks per page, update pagination controls. Filter buttons: update query and reload tasks. Task rendering: create DOM elements with proper data attributes, attach event listeners via delegation on task-list container."
        },
        {
          "path": "server.py",
          "type": "python",
          "description": "Flask backend with JWT authentication: use Flask-JWT-Extended for token management, Flask-CORS for cross-origin requests, Flask-SQLAlchemy for database (SQLite). Models: User (id, username, password_hash) with password hashing via werkzeug.security, Task (id, title, completed, priority, due_date, user_id, created_at, assigned_to). Routes: POST /api/auth/login (verify credentials, return JWT), POST /api/auth/register (create user), GET /api/tasks (query by status/priority/search with pagination, return {tasks: [], total: int, page: int}), POST /api/tasks (create task, require JWT), PUT /api/tasks/<id> (update task, verify ownership), DELETE /api/tasks/<id> (delete task, verify ownership), PATCH /api/tasks/<id>/toggle (toggle completed), GET /api/tasks/stream (SSE endpoint for real-time updates). Use @jwt_required() decorator, handle errors with proper HTTP status codes, validate request data, return consistent JSON responses."
        },
        {
          "path": "config.py",
          "type": "python",
          "description": "Flask configuration: load environment variables for SECRET_KEY, JWT_SECRET_KEY, DATABASE_URI, CORS_ORIGINS. Define Config class with settings for SQLAlchemy (track modifications off, echo for development), JWT expiration (24 hours), pagination defaults (10 per page), allowed priorities (low, medium, high). Include development and production config classes."
        },
        {
          "path": "requirements.txt",
          "type": "text",
          "description": "Python dependencies: Flask==3.0.0, Flask-JWT-Extended==4.6.0, Flask-CORS==4.0.0, Flask-SQLAlchemy==3.1.1, python-dotenv==1.0.0, werkzeug==3.0.1"
        },
        {
          "path": "package.json",
          "type": "json",
          "description": "Standard JSON file (NOT C header) for Node.js package configuration. Use valid JSON syntax: {\"name\": \"project-name\", \"version\": \"1.0.0\", \"description\": \"...\", \"scripts\": {\"start\": \"node server.js\"}, \"dependencies\": {}}. Include all required npm packages."
        },
        {
          "path": "README.md",
          "type": "markdown",
          "description": "Pure Markdown documentation (NOT HTML). Write in standard Markdown format with headers (# ## ###), bullet lists (- or *), code blocks (```), and links ([text](url)). Include: project title and description, prerequisites, installation steps (create venv, install dependencies), how to run the application, API endpoints documentation, configuration instructions (environment variables), troubleshooting tips. Use proper Markdown syntax only, no HTML tags."
        },
        {
          "path": "start.ps1",
          "type": "powershell",
          "description": "Windows PowerShell script to activate venv, install dependencies, initialize database, and start the server"
        },
        {
          "path": "init_db.py",
          "type": "python",
          "description": "Database initialization script: create tables, add test data (admin/admin123, demo/demo123)"
        }
      ],
      "contracts": {
        "api": [
          {
            "endpoint": "POST /api/auth/login",
            "method": "POST",
            "description": "Authenticate user and return JWT token",
            "request": {
              "username": "string",
              "password": "string"
            },
            "response": {
              "success": {
                "access_token": "string",
                "username": "string"
              },
              "error": {
                "error": "string"
              }
            },
            "status_codes": {
              "200": "Success",
              "400": "Missing fields",
              "401": "Invalid credentials"
            },
            "producers": [
              "server.py"
            ],
            "consumers": [
              "app.js (handleLogin)"
            ]
          },
          {
            "endpoint": "GET /api/tasks",
            "method": "GET",
            "description": "Get paginated tasks with filters",
            "query_params": {
              "status": "all|active|completed|overdue (optional)",
              "priority": "low|medium|high (optional)",
              "search": "string (optional)",
              "page": "integer (default: 1)"
            },
            "response": {
              "tasks": [
                {
                  "id": "integer",
                  "title": "string",
                  "completed": "boolean",
                  "priority": "string",
                  "due_date": "string (ISO 8601)",
                  "created_at": "string (ISO 8601)",
                  "assigned_to": "string|null"
                }
              ],
              "total": "integer",
              "page": "integer",
              "pages": "integer"
            },
            "status_codes": {
              "200": "Success",
              "401": "Unauthorized"
            },
            "producers": [
              "server.py"
            ],
            "consumers": [
              "app.js (loadTasks)"
            ]
          },
          {
            "endpoint": "POST /api/tasks",
            "method": "POST",
            "description": "Create new task",
            "request": {
              "title": "string (required)",
              "priority": "string (low|medium|high, default: medium)",
              "due_date": "string (ISO 8601, optional)"
            },
            "response": {
              "id": "integer",
              "title": "string",
              "completed": "boolean",
              "priority": "string",
              "due_date": "string|null",
              "created_at": "string"
            },
            "status_codes": {
              "201": "Created",
              "400": "Invalid data",
              "401": "Unauthorized"
            },
            "producers": [
              "server.py"
            ],
            "consumers": [
              "app.js (handleAddTask)"
            ]
          },
          {
            "endpoint": "PUT /api/tasks/:id",
            "method": "PUT",
            "description": "Update task",
            "request": {
              "title": "string (optional)",
              "priority": "string (optional)",
              "due_date": "string (optional)"
            },
            "response": {
              "id": "integer",
              "title": "string",
              "completed": "boolean",
              "priority": "string",
              "due_date": "string|null"
            },
            "status_codes": {
              "200": "Success",
              "401": "Unauthorized",
              "403": "Not task owner",
              "404": "Task not found"
            },
            "producers": [
              "server.py"
            ],
            "consumers": [
              "app.js (handleEditTask)"
            ]
          },
          {
            "endpoint": "DELETE /api/tasks/:id",
            "method": "DELETE",
            "description": "Delete task",
            "response": {
              "message": "string"
            },
            "status_codes": {
              "200": "Success",
              "401": "Unauthorized",
              "403": "Not task owner",
              "404": "Task not found"
            },
            "producers": [
              "server.py"
            ],
            "consumers": [
              "app.js (handleDeleteTask)"
            ]
          },
          {
            "endpoint": "PATCH /api/tasks/:id/toggle",
            "method": "PATCH",
            "description": "Toggle task completion status",
            "response": {
              "id": "integer",
              "completed": "boolean"
            },
            "status_codes": {
              "200": "Success",
              "401": "Unauthorized",
              "403": "Not task owner",
              "404": "Task not found"
            },
            "producers": [
              "server.py"
            ],
            "consumers": [
              "app.js (handleToggleTask)"
            ]
          }
        ],
        "dom": [
          {
            "description": "Login view container and form elements",
            "containerId": "login-view",
            "requiredElements": [
              {
                "selector": "#username-input",
                "element": "input",
                "attributes": {
                  "type": "text",
                  "required": "true"
                },
                "purpose": "Username input field",
                "consumers": [
                  "app.js (handleLogin)"
                ]
              },
              {
                "selector": "#password-input",
                "element": "input",
                "attributes": {
                  "type": "password",
                  "required": "true"
                },
                "purpose": "Password input field",
                "consumers": [
                  "app.js (handleLogin)"
                ]
              },
              {
                "selector": "#login-btn",
                "element": "button",
                "purpose": "Trigger login",
                "consumers": [
                  "app.js (handleLogin)"
                ]
              },
              {
                "selector": "#login-error",
                "element": "div",
                "purpose": "Display login error messages",
                "consumers": [
                  "app.js (showLoginError)"
                ]
              }
            ],
            "producers": [
              "index.html"
            ],
            "consumers": [
              "app.js"
            ]
          },
          {
            "description": "Todo view container and task management elements",
            "containerId": "todo-view",
            "requiredElements": [
              {
                "selector": "#task-input",
                "element": "input",
                "attributes": {
                  "type": "text",
                  "placeholder": "Add new task..."
                },
                "purpose": "Task title input",
                "consumers": [
                  "app.js (handleAddTask)"
                ]
              },
              {
                "selector": "#priority-select",
                "element": "select",
                "purpose": "Priority dropdown with options: low, medium, high",
                "consumers": [
                  "app.js (handleAddTask)"
                ]
              },
              {
                "selector": "#due-date",
                "element": "input",
                "attributes": {
                  "type": "date"
                },
                "purpose": "Due date picker",
                "consumers": [
                  "app.js (handleAddTask)"
                ]
              },
              {
                "selector": "#add-btn",
                "element": "button",
                "purpose": "Add new task button",
                "consumers": [
                  "app.js (handleAddTask)"
                ]
              },
              {
                "selector": "#search-input",
                "element": "input",
                "attributes": {
                  "type": "search",
                  "placeholder": "Search tasks..."
                },
                "purpose": "Search tasks input with debounce",
                "consumers": [
                  "app.js (handleSearch)"
                ]
              },
              {
                "selector": "#task-list",
                "element": "div",
                "purpose": "Container for task items, uses event delegation",
                "consumers": [
                  "app.js (renderTasks, handleTaskAction)"
                ]
              },
              {
                "selector": "#task-count",
                "element": "span",
                "purpose": "Display active task count",
                "consumers": [
                  "app.js (updateTaskCount)"
                ]
              },
              {
                "selector": "#pagination",
                "element": "div",
                "purpose": "Pagination controls",
                "consumers": [
                  "app.js (renderPagination)"
                ]
              },
              {
                "selector": "#logout-btn",
                "element": "button",
                "purpose": "Logout button",
                "consumers": [
                  "app.js (handleLogout)"
                ]
              }
            ],
            "producers": [
              "index.html"
            ],
            "consumers": [
              "app.js"
            ]
          },
          {
            "description": "Filter buttons using data-filter attribute",
            "requiredElements": [
              {
                "selector": "[data-filter]",
                "element": "button",
                "attributes": {
                  "data-filter": "all|active|completed|overdue"
                },
                "purpose": "Filter tasks by status, read filter value from data-filter attribute",
                "consumers": [
                  "app.js (handleFilterClick via data-filter)"
                ]
              }
            ],
            "producers": [
              "index.html"
            ],
            "consumers": [
              "app.js"
            ]
          },
          {
            "description": "Task item structure with data attributes for actions",
            "requiredElements": [
              {
                "selector": ".task-checkbox",
                "element": "input",
                "attributes": {
                  "type": "checkbox",
                  "data-task-id": "integer"
                },
                "purpose": "Toggle task completion, task ID stored in data-task-id",
                "consumers": [
                  "app.js (handleToggleTask via data-task-id)"
                ]
              },
              {
                "selector": ".task-title",
                "element": "span",
                "purpose": "Display task title",
                "consumers": [
                  "app.js (renderTasks)"
                ]
              },
              {
                "selector": ".priority-badge",
                "element": "span",
                "purpose": "Display priority badge with color coding",
                "consumers": [
                  "app.js (renderTasks)"
                ]
              },
              {
                "selector": ".due-date",
                "element": "span",
                "purpose": "Display due date",
                "consumers": [
                  "app.js (renderTasks)"
                ]
              },
              {
                "selector": "[data-action='edit']",
                "element": "button",
                "attributes": {
                  "data-action": "edit",
                  "data-task-id": "integer"
                },
                "purpose": "Edit task button, reads action from data-action and ID from data-task-id",
                "consumers": [
                  "app.js (handleTaskAction via data-action)"
                ]
              },
              {
                "selector": "[data-action='delete']",
                "element": "button",
                "attributes": {
                  "data-action": "delete",
                  "data-task-id": "integer"
                },
                "purpose": "Delete task button, reads action from data-action and ID from data-task-id",
                "consumers": [
                  "app.js (handleTaskAction via data-action)"
                ]
              }
            ],
            "producers": [
              "app.js (renderTasks dynamically creates these)"
            ],
            "consumers": [
              "app.js (event delegation on task-list)"
            ]
          }
        ],
        "storage": [
          {
            "key": "jwt_token",
            "type": "localStorage",
            "description": "Store JWT authentication token",
            "structure": "string",
            "producers": [
              "app.js (handleLogin)"
            ],
            "consumers": [
              "app.js (checkAuth, API requests)"
            ]
          },
          {
            "key": "current_filter",
            "type": "localStorage",
            "description": "Remember last selected filter",
            "structure": "string (all|active|completed|overdue)",
            "producers": [
              "app.js (handleFilterClick)"
            ],
            "consumers": [
              "app.js (loadTasks)"
            ]
          }
        ],
        "events": [
          {
            "name": "task-updated",
            "description": "Fired when task is updated via SSE",
            "payload": {
              "task": "Task object from API"
            },
            "emitters": [
              "app.js (handleSSEMessage)"
            ],
            "listeners": [
              "app.js (reloadCurrentView)"
            ]
          }
        ]
      },
      "projectConfig": {
        "name": "todo-list-app",
        "type": "fullstack",
        "runtime": "mixed",
        "buildTool": "pip",
        "pythonVersion": "3.9+",
        "dependencies": {
          "python": [
            "Flask",
            "Flask-JWT-Extended",
            "Flask-CORS",
            "Flask-SQLAlchemy",
            "python-dotenv",
            "werkzeug"
          ]
        }
      }
    }
  },
  "technicalRequirements": [
    {
      "category": "JWT Authentication",
      "requirements": [
        "CRITICAL: JWT identity MUST be string type",
        "When creating token: create_access_token(identity=str(user.id))",
        "When reading token: current_user_id = int(get_jwt_identity())",
        "Apply to all protected routes: get_tasks, create_task, update_task, delete_task, toggle_task_completion"
      ]
    },
    {
      "category": "JWT Configuration",
      "requirements": [
        "Disable CSRF for API-only backend",
        "Add to Flask config: app.config['JWT_CSRF_CHECK_FORM'] = False",
        "Reason: API uses Bearer token authentication, CSRF not needed"
      ]
    },
    {
      "priority": "CRITICAL",
      "category": "JWT Authentication",
      "requirement": "JWT identity must be string type: use str(user.id) when creating, int(get_jwt_identity()) when reading"
    }
  ],
  "contracts": {
    "api": [],
    "dom": []
  },
  "_preprocessed": {
    "by": "contracts-agent",
    "version": "1.0.0",
    "timestamp": "2025-11-23T09:46:49.574Z",
    "issuesFound": 6,
    "enhancementsApplied": true
  }
}