<!-- file: tests/index.test.js -->
```javascript
const request = require('supertest');
const app = require('../src/index');

describe('Server and API Endpoints', () => {
  it('should start the server and listen on the correct port', async () => {
    const response = await request(app).get('/');
    expect(response.status).toBe(200);
  });

  it('should handle 404 errors', async () => {
    const response = await request(app).get('/nonexistent');
    expect(response.status).toBe(404);
  });
});
```

<!-- file: tests/controllers/userController.test.js -->
```javascript
const request = require('supertest');
const app = require('../../src/index');
const User = require('../../src/models/User');

describe('UserController Tests', () => {
  beforeEach(async () => {
    await User.deleteMany({});
  });

  it('should register a new user', async () => {
    const userData = { username: 'testuser', password: 'password123', email: 'test@example.com', role: 'user' };
    const response = await request(app).post('/api/users/register').send(userData);
    expect(response.status).toBe(201);
    expect(response.body.message).toBe('User registered');
    expect(response.body.userId).toBeDefined();
  });

  it('should fail to register with incomplete data', async () => {
    const userData = { username: 'testuser' };
    const response = await request(app).post('/api/users/register').send(userData);
    expect(response.status).toBe(500);
  });

  it('should authenticate a user', async () => {
    const userData = { username: 'testuser', password: 'password123', email: 'test@example.com', role: 'user' };
    await new User(userData).save();
    const response = await request(app).post('/api/users/login').send({ username: 'testuser', password: 'password123' });
    expect(response.status).toBe(200);
    expect(response.body.token).toContain('fake-jwt-token-for-');
  });

  it('should reject authentication with wrong credentials', async () => {
    const response = await request(app).post('/api/users/login').send({ username: 'wronguser', password: 'wrongpass' });
    expect(response.status).toBe(401);
    expect(response.body.message).toBe('Authentication failed');
  });
});
```

<!-- file: tests/controllers/menuController.test.js -->
```javascript
const request = require('supertest');
const app = require('../../src/index');
const MenuItem = require('../../src/models/MenuItem');

describe('MenuController Tests', () => {
  beforeEach(async () => {
    await MenuItem.deleteMany({});
  });

  it('should add a new menu item', async () => {
    const menuItemData = { name: 'Pizza', description: 'Delicious cheese pizza', price: 9.99, availability: true };
    const response = await request(app).post('/api/menu/add').send(menuItemData);
    expect(response.status).toBe(201);
    expect(response.body.message).toBe('Menu item added');
    expect(response.body.menuItemId).toBeDefined();
  });

  it('should update an existing menu item', async () => {
    const menuItem = new MenuItem({ name: 'Burger', description: 'Juicy beef burger', price: 8.99, availability: true });
    await menuItem.save();
    const updateData = { id: menuItem._id, name: 'Cheese Burger', price: 10.99 };
    const response = await request(app).put('/api/menu/update').send(updateData);
    expect(response.status).toBe(200);
    expect(response.body.message).toBe('Menu item updated');
    expect(response.body.menuItem.name).toBe('Cheese Burger');
  });

  it('should fail to update a non-existent menu item', async () => {
    const updateData = { id: 'nonexistentid', name: 'Cheese Burger', price: 10.99 };
    const response = await request(app).put('/api/menu/update').send(updateData);
    expect(response.status).toBe(404);
    expect(response.body.message).toBe('Menu item not found');
  });
});
```

<!-- file: tests/models/userModel.test.js -->
```javascript
const mongoose = require('mongoose');
const User = require('../../src/models/User');

describe('User Model Tests', () => {
  beforeAll(async () => {
    await mongoose.connect(process.env.MONGODB_URI, { useNewUrlParser: true, useUnifiedTopology: true });
  });

  afterAll(async () => {
    await mongoose.disconnect();
  });

  it('should create and save a user successfully', async () => {
    const userData = { username: 'newuser', password: 'password', email: 'newuser@example.com', role: 'admin' };
    const user = new User(userData);
    const savedUser = await user.save();
    expect(savedUser._id).toBeDefined();
    expect(savedUser.username).toBe(userData.username);
  });

  it('should not save a user without the required fields', async () => {
    const user = new User({ username: 'onlyusername' });
    await expect(user.save()).rejects.toThrow(mongoose.Error.ValidationError);
  });
});
```